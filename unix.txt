curl https://www.spinellis.gr/cgi-bin/oasa-history?id=p2822109 -o oasa.gz
gunzip oasa.gz

1. ,

2. Dataset too large for excel grid, file not completely loaded.

4. How many records are provided with the data?

5. What is the data acquisition time stamp of the last record in the stream you fetched?

2022-03-12T19:21:06

tail -n 1 oasa   #fetches the last line of the file

6. How many different buses appear in the data?

1589

awk -F ',' '{print $3}' oasa | sort | uniq | wc -l

# awk -F ',' '{print $3}': use comma as delimiter and print the third column
# sort: pipe the output to sort command to sort the data
# uniq: pipe the output to uniq command to remove duplicates 
# wc -l: pipe the output to wc -l command to count the lines

7. How many different routes are covered by the data?

472

awk -F ',' '{print $2}' oasa | sort | uniq | wc -l

# awk -F ',' '{print $2}': use comma as delimiter and print the second column
# sort: pipe the output to sort command to sort the data
# uniq: pipe the output to uniq command to remove duplicates 
# wc -l: pipe the output to wc -l command to count the lines

8. How many dates are covered by the data?

71

cut -d "T" -f 1 oasa | sort | uniq | wc -l

# cut -d "T" -f 1: use cut command with T as delimiter to extract date from first column
# sort: pipe the output to sort command to sort the data
# uniq: pipe the output to uniq command to remove duplicates 
# wc -l: pipe the output to wc -l command to count the lines

9. Which route is associated with the most position reports?

3629

awk '!seen[$5,$6]++' oasa | awk -F ',' '{print $2}'| sort | uniq -c | sort -nr | head -1

# awk '!seen[$5,$6]++': remove duplicates in 5th and 6th columns without pre-sorting
# awk -F ',' '{print $2}': use comma as delimiter and print 2nd column of output 
# sort: pipe the output to sort command to sort the data
# uniq: pipe the output to uniq command with -c to get the number of occurences
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# head -1: pipe the output to head -1 command to print route with most position reports

10. How many position reports appear in the data more than once?

543630

awk -F ',' '{print $5,$6}' oasa | sort | uniq -d | wc -l

# awk -F ',' '{print $5,$6}': use comma as delimiter and print the 5th and 6th columns
# sort: pipe the output to sort command to sort the data
# uniq -d: pipe the output to uniq command with -d to print the repeated lines 
# wc -l: pipe the output to wc -l command to count the lines

11. Which is the most frequent first two-digit sequence in numbers assigned to buses?

30 248

awk -F ',' '{print $3}' oasa | sort -u | cut -c -2 | sort | uniq -c | sort -nr | head -1

# awk -F ',' '{print $3}': use comma as delimiter and print the 3rd column
# sort -u: sort and remove duplicates at the same time to get unique buses
# cut -c -2: use cut command to output to extract the first two digits from bus number
# sort: pipe the output to sort command to sort the data
# uniq -c: pipe the output to uniq command with -c to get the number of occurences 
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# head -1: pipe the output to head -1 command to get the most frequent

12. How many buses did not travel on this year's February 6th?

934

grep 'Feb  6 2022' oasa | awk -F ',' '{print $3}' | sort | uniq > bus6f.txt
awk -F ',' '{print $3}' oasa| sort | uniq > uniq_buses.txt
comm -3 uniq_buses.txt bus6f.txt | wc -l 

# grep 'Feb  6 2022': search for February 6th 2022
# awk -F ',' '{print $3}': use comma as delimiter and print the 3rd column
# sort: pipe the output to sort command to sort the data
# uniq: pipe the output to uniq command to remove duplicates 
# > bus6f.txt: save output to file bus6f.txt
# similarly, save all unique buses to file uniq_buses.txt
# comm -3 to find not common lines between uniq_buses.txt and bus6f.txt
# wc -l: pipe the output to wc -l command to count the lines

13. On which date were the most buses on the road?

2022-02-03

awk -F ',' '{print $3 "," substr($4,1,11)}' oasa | sort -k2 | uniq | awk -F ',' '{print $2}' | sort | uniq -c | sort -nr | head -1

# awk -F ',' '{print $3 "," substr($4,1,11)}': use comma as delimiter and print the 3rd column and the date from 4th column
# sort -k2: pipe the output to sort command to sort the 2nd column
# uniq: pipe the output to uniq command to remove duplicates
# awk -F ',' '{print $2}': print the date
# sort: pipe the output to sort command to sort the data
# uniq -c: pipe the output to uniq command with -c to get the number of occurences 
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# head -1: pipe the output to head -1 command to get the most frequent

14. Which route has been served by the highest number of different buses?

231 3566

awk -F ',' '{print $2,$3}' oasa | sort -k2 | uniq | awk '{print$1}' | sort | uniq -c | sort -nr | head -1

# awk -F ',' '{print $2,$3}': use comma as delimiter and print the 2nd and 3rd columns
# sort -k2: pipe the output to sort command to sort the 2nd column
# uniq: pipe the output to uniq command to remove duplicates
# awk '{print$1}': print the route
# sort: pipe the output to sort command to sort the data
# uniq -c: pipe the output to uniq command with -c to get the number of occurences 
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# head -1: pipe the output to head -1 command to get the most frequent

15. On which hour of the day (e.g. 09) are there overall the most buses on the road?

1588 08

awk -F ',' '{print $3 "," substr($4,13,2)substr($4,25,2)}' oasa | sort -k2 | uniq | awk -F ',' '{print $2}' | sort | uniq -c | sort -nr | head -1

# awk -F ',' '{print $3 "," substr($4,13,2)substr($4,25,2)}': use comma as delimiter and print the 3rd column and the hour from 4th column along with AM/PM
# sort -k2: pipe the output to sort command to sort the 2nd column
# uniq: pipe the output to uniq command to remove duplicates
# awk -F ',' '{print $2}': print the hour
# sort: pipe the output to sort command to sort the data
# uniq -c: pipe the output to uniq command with -c to get the number of occurences 
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# head -1: pipe the output to head -1 command to get the most frequent

16. On which hour of the day (e.g. 23) are there overall the fewest buses on the road?

755 03

awk -F ',' '{print $3 "," substr($4,13,2)substr($4,25,2)}' oasa | sort -k2 | uniq | awk -F ',' '{print $2}' | sort | uniq -c | sort -nr | tail -1

# awk -F ',' '{print $3 "," substr($4,13,2)substr($4,25,2)}': use comma as delimiter and print the 3rd column and the hour from 4th column along with AM/PM
# sort -k2: pipe the output to sort command to sort the 2nd column
# uniq: pipe the output to uniq command to remove duplicates
# awk -F ',' '{print $2}': print the hour
# sort: pipe the output to sort command to sort the data
# uniq -c: pipe the output to uniq command with -c to get the number of occurences 
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# tail -1: pipe the output to tail -1 command to get the least frequent

17. For which weekday (e.g. Wednesday) does your data set contain the most records?


awk -F ',' '{print $4}' oasa | awk '{print $1, $2, $3}' > weekday.txt
date -f weekday.txt +%A | sort | uniq -c | sort -nr | head -1

# awk -F ',' '{print $4}': use comma as delimiter and print the 4th column
# awk '{print $1, $2, $3}': extract the date
# > weekday.txt: save output to weekday.txt
# date -f weekday.txt +%A: extract the weekday from the date
# sort: pipe the output to sort command to sort the data
# uniq -c: pipe the output to uniq command with -c to get the number of occurences 
# sort -nr: pipe the output to sort command with -nr for reverse numeric order
# head -1: pipe the output to head -1 command to get the weekday with most records

18. What are the bounding box geographic coordinates of the area served by the buses?

awk -F ',' '{print $5}' oasa | sort -nr | head -1    # most northern latitude (maximum latitude)
awk -F ',' '{print $5}' oasa | sort -nr | tail -1       # most southern latitude (minimum latitude)
awk -F ',' '{print $6}' oasa | sort -nr | tail -1       # most western longitude (minimum longitude)
awk -F ',' '{print $6}' oasa | sort -nr | head -1    # most eastern longitude (maximum longitude)        

19. Which bus has appeared closest to your favorite location?

awk -F ',' '{print $3,$5,$6, sqrt (($5-38.0370765)^2 + ($6-23.9061296)^2)}' oasa | sort -u | sort -k4 | head -1

# awk -F ',' '{print $3,$5,$6, sqrt (($5-38.0370765)^2 + ($6-23.9061296)^2)}': print the 3rd, 5th and 6th columns along with the Euclidean distance for favorite location
# sort -u: sort and remove duplicates at the same time
# sort -k4: sort the Euclidean distance
# head -1: get the minimum Euclidean distance

20. How many position reports have been sent by the chosen bus?

6711

awk -F ','  '{print $3,$5,$6}' oasa | awk '{if($1=="60924") print $2,$3}' | sort -u | wc -l

# awk -F ','  '{print $3,$5,$6}': use comma as delimiter and print the 3rd, 5th and 6th columns
# awk '{if($1=="60924") print $2,$3}': print latitude, longitude for chosen bus
# sort -u: sort and remove duplicates at the same time
# wc -l: count the lines

21. What was the chosen bus's last position in the obtained data stream?

12:59:46:000PM 37.9756470 23.7459490

awk -F ',' '{print $3,$4,$5,$6}' oasa | awk '{if($1=="60924") print $5,$6,$7}' | sort -k1 | tail -1

# use comma as delimiter and print the 3rd, 4th, 5th and 6th columns
# print timestamp, latitude, longitude for chosen bus
# sort timestamp column
# tail -1 command to get the chosen bus's last position

22. On which date has the chosen bus given the most position reports?

195 Jan 20 2022

awk -F ',' '{print $3,$4,$5,$6}' oasa | awk '{if($1=="60924") print $2,$3,$4}' | sort -nr | uniq -c | sort -k1 -nr | head -1

# use comma as delimiter and print the 3rd, 4th, 5th and 6th columns
# print dates for chosen bus
# pipe the output to sort command with -nr for reverse numeric order
# pipe the output to uniq command with -c to get the number of occurences
# sort first column
# get the date with most position reports

23. On how many routes has the chosen bus traveled?

35

awk -F ',' '{print $2,$3}' oasa | awk '{if($2=="60924") print $1}' | sort -u | wc -l

# awk -F ',' '{print $2,$3}': use comma as delimiter and print the 2nd and 3rd columns
# awk '{if($2=="60924") print $1}': print routes for chosen bus
# sort -u: sort and remove duplicates
# wc -l: count the lines

awk -F ',' '{print $3,$4,$5,$6}' oasa | awk '{if($1=="60924") print $2,$3,$4}' | sort | uniq -c | sort -k1 -nr | head -1

24. How many buses have shared at least one route with the chosen bus?

329

awk -F ',' '{print $2,$3}' oasa | awk '{if($2=="60924") print $1}' | sort -u > routes1.txt
awk -F ',' '{print $2,$3}' oasa | awk '{if($2!="60924") print $1,$2}' | sort -u > routes2.txt
join -1 1 -2 1 routes1.txt routes2.txt > routes3.txt
awk -F ',' '{print $1,$2}' routes3.txt | awk '{print $2}' | sort -u | wc -l

# awk -F ',' '{print $2,$3}': use comma as delimiter and print the 2nd and 3rd columns
# awk '{if($2=="60924") print $1}': print routes for chosen bus
# sort -u: sort and remove duplicates at the same time
# > routes1.txt: save output to routes1.txt
# awk -F ',' '{print $2,$3}': use comma as delimiter and print the 2nd and 3rd columns
# awk '{if($2!="60924") print $1,$2}': print routes for all other buses except for the chosen bus
# sort -u: sort and remove duplicates at the same time
# > routes2.txt: save output to routes2.txt
# join -1 1 -2 1 routes1.txt routes2.txt: join 1st columns (routes) from both files
# > routes3.txt: save to routes3.txt
# awk -F ',' '{print $1,$2}' routes3.txt | awk '{print $2}': print routes from routes3.txt
# sort -u: sort and remove duplicates at the same time
# wc -l: count the lines